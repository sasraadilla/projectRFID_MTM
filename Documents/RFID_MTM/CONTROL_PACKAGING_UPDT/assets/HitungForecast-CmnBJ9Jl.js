import{a as l,j as e,C as F}from"./index-fIXkcG0q.js";import{a as k,c as w}from"./index.esm-Cme2ool-.js";import{a as y}from"./axios-B17pQD9q.js";import{S as p}from"./sweetalert2.esm.all-BQxta0Da.js";import{c as L,a as O}from"./cil-cloud-upload-DTa66xq_.js";import{C as K,a as S}from"./CRow-B962IMet.js";import{C as j,a as C}from"./CCardBody-CRtrtls-.js";import{C as v,e as I,b as c,c as t,a as T,d as n}from"./CTable-DnddnBdL.js";const Y=()=>{const[g,h]=l.useState([]),[x,$]=l.useState([]),[o,R]=l.useState(new Date().getFullYear().toString()),[m,D]=l.useState(""),[_,b]=l.useState(!1),d=l.useRef(null),W=async()=>{try{const r=await y.get("/customers");$(r.data)}catch{p.fire("Error","Gagal load filter data","error")}};l.useEffect(()=>{W(),u()},[]);const u=async()=>{if(!o){p.fire("Info","Pilih tahun terlebih dahulu","warning");return}b(!0);try{let r=`/forecast/calc?year=${o}`;m&&(r+=`&customer_id=${m}`);const a=await y.get(r);h(a.data)}catch(r){console.error(r);const a=r.response?.data?.message||r.message||"Gagal mengambil data kalkulasi";p.fire("Error",a,"error")}finally{b(!1)}},P=async r=>{const a=r.target.files[0];if(!a)return;const s=new FormData;s.append("file",a),b(!0);try{await y.post("/forecast/import",s,{headers:{"Content-Type":"multipart/form-data"}}),p.fire("Berhasil","Data forecast berhasil diimport","success"),u()}catch(N){console.error(N),p.fire("Error","Gagal import CSV","error")}finally{b(!1),d.current&&(d.current.value="")}},E=()=>{d.current&&d.current.click()},B=[{part_number:"123",part_name:"ABC",customer_name:"PT.AAA",packaging:"Trolley",qty_packaging:100,hari_kerja:20,forecasts:{[`Oktober_${parseInt(o)-1}`]:1e4,[`November_${parseInt(o)-1}`]:2e5,[`Desember_${parseInt(o)-1}`]:5e4,[`Januari_${o}`]:6e4,[`Februari_${o}`]:1e4},need_prod:5,need_store:10,need_cust:15,total_need:30,actual:25,gap:-5,status:"Kurang",lt_production:1,lt_store:2,lt_customer:3},{part_number:"456",part_name:"DEF",customer_name:"PT.BBB",packaging:"Dolly",qty_packaging:50,hari_kerja:20,forecasts:{[`Oktober_${parseInt(o)-1}`]:5e3,[`November_${parseInt(o)-1}`]:1e3,[`Desember_${parseInt(o)-1}`]:4e3,[`Januari_${o}`]:3e3,[`Februari_${o}`]:5e3},need_prod:5,need_store:10,need_cust:15,total_need:30,actual:45,gap:15,status:"Lebih",lt_production:5,lt_store:10,lt_customer:15},{part_number:"789",part_name:"GHI",customer_name:"PT.CCC",packaging:"Pallet",qty_packaging:50,hari_kerja:20,forecasts:{[`Oktober_${parseInt(o)-1}`]:7e3,[`November_${parseInt(o)-1}`]:6e3,[`Desember_${parseInt(o)-1}`]:8e3,[`Januari_${o}`]:4500,[`Februari_${o}`]:7e3},need_prod:7,need_store:14,need_cust:21,total_need:42,actual:42,gap:0,status:"Pass",lt_production:7,lt_store:14,lt_customer:21}],i=g.length>0?g:B,f={Kurang:i.filter(r=>r.status==="Kurang").length,Lebih:i.filter(r=>r.status==="Lebih").length,Pass:i.filter(r=>r.status==="Pass").length};return e.jsxs("div",{style:{padding:"20px",background:"#f4f7fc",minHeight:"100vh"},children:[e.jsx("input",{type:"file",ref:d,style:{display:"none"},accept:".csv",onChange:P}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px",backgroundColor:"#fff",padding:"15px 20px",borderRadius:"12px",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontWeight:"700",color:"#1e293b",margin:0},children:"Dashboard Kebutuhan"}),e.jsxs("p",{style:{color:"#64748b",margin:0,fontSize:"0.9rem"},children:["Total ",i.length," Parts"]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[e.jsxs("select",{value:m,onChange:r=>D(r.target.value),style:{padding:"8px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",backgroundColor:"#fff",fontSize:"0.9rem",color:"#334155",outline:"none",minWidth:"200px"},children:[e.jsx("option",{value:"",children:"Semua Customer"}),x.map(r=>e.jsx("option",{value:r.id,children:r.customer_name||r.name},r.id))]}),e.jsx("input",{type:"number",value:o,onChange:r=>R(r.target.value),style:{padding:"8px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",width:"100px",fontWeight:"600",color:"#334155"}}),e.jsxs(k,{color:"primary",onClick:E,style:{display:"flex",alignItems:"center",gap:"8px",fontWeight:"600",borderRadius:"8px",backgroundColor:"#3b82f6",border:"none"},children:[e.jsx(w,{icon:L})," Input CSV"]}),e.jsx(k,{color:"success",onClick:u,disabled:_,style:{display:"flex",alignItems:"center",gap:"8px",fontWeight:"600",color:"white",borderRadius:"8px",border:"none"},children:_?e.jsx(F,{size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsx(w,{icon:O})," Hitung"]})})]})]}),e.jsxs(K,{children:[e.jsxs(S,{md:9,children:[e.jsx(j,{className:"mb-4",style:{borderRadius:"12px",border:"none",boxShadow:"0 4px 15px rgba(0,0,0,0.05)",overflow:"hidden"},children:e.jsxs(C,{style:{padding:"0"},children:[e.jsx("div",{style:{padding:"15px 20px",backgroundColor:"#fff",borderBottom:"1px solid #f1f5f9"},children:e.jsx("h6",{style:{fontWeight:"700",margin:0,color:"#334155"},children:"FORECAST (pcs)/month"})}),e.jsxs(v,{responsive:!0,hover:!0,style:{fontSize:"0.85rem",marginBottom:0},children:[e.jsxs(I,{children:[e.jsxs(c,{children:[e.jsx(t,{rowSpan:2,style:{backgroundColor:"#3b82f6 !important",color:"white !important",verticalAlign:"middle",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important",padding:"12px"},children:"PART NUMBER"}),e.jsx(t,{rowSpan:2,style:{backgroundColor:"#3b82f6 !important",color:"white !important",verticalAlign:"middle",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"PART NAME"}),e.jsx(t,{rowSpan:2,style:{backgroundColor:"#3b82f6 !important",color:"white !important",verticalAlign:"middle",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"CUSTOMER"}),e.jsx(t,{colSpan:2,style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"PACKAGING"}),e.jsx(t,{colSpan:3,style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:parseInt(o)-1}),e.jsx(t,{colSpan:2,style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:o})]}),e.jsxs(c,{children:[e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"JENIS"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"QTY"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"OCT"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"NOV"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"DEC"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"JAN"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"FEB"})]})]}),e.jsx(T,{children:i.map((r,a)=>e.jsxs(c,{style:{backgroundColor:a%2===0?"#fff":"#f8fafc"},children:[e.jsx(n,{style:{textAlign:"center",fontWeight:"600",color:"#1e293b"},children:r.part_number}),e.jsx(n,{style:{color:"#475569"},children:r.part_name}),e.jsx(n,{style:{fontWeight:"500"},children:r.customer_name}),e.jsx(n,{style:{textAlign:"center"},children:e.jsx("span",{style:{backgroundColor:"#f1f5f9",padding:"2px 8px",borderRadius:"4px",fontSize:"0.75rem",fontWeight:"700",color:"#64748b"},children:r.packaging})}),e.jsx(n,{style:{textAlign:"center",fontWeight:"700"},children:r.qty_packaging}),e.jsx(n,{style:{textAlign:"center"},children:r.forecasts[`Oktober_${parseInt(o)-1}`]?.toLocaleString()||0}),e.jsx(n,{style:{textAlign:"center"},children:r.forecasts[`November_${parseInt(o)-1}`]?.toLocaleString()||0}),e.jsx(n,{style:{textAlign:"center"},children:r.forecasts[`Desember_${parseInt(o)-1}`]?.toLocaleString()||0}),e.jsx(n,{style:{textAlign:"center"},children:r.forecasts[`Januari_${o}`]?.toLocaleString()||0}),e.jsx(n,{style:{textAlign:"center"},children:r.forecasts[`Februari_${o}`]?.toLocaleString()||0})]},a))})]})]})}),e.jsx(j,{style:{borderRadius:"12px",border:"none",boxShadow:"0 4px 15px rgba(0,0,0,0.05)",overflow:"hidden"},children:e.jsxs(C,{style:{padding:"0"},children:[e.jsx("div",{style:{padding:"15px 20px",backgroundColor:"#fff",borderBottom:"1px solid #f1f5f9"},children:e.jsx("h6",{style:{fontWeight:"700",margin:0,color:"#334155"},children:"FORECAST (pcs)/day + Total Kebutuhan"})}),e.jsxs(v,{responsive:!0,hover:!0,style:{fontSize:"0.85rem",marginBottom:0},children:[e.jsxs(I,{children:[e.jsxs(c,{children:[e.jsx(t,{rowSpan:2,style:{backgroundColor:"#3b82f6 !important",color:"white !important",verticalAlign:"middle",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important",padding:"12px"},children:"PART NUMBER"}),e.jsx(t,{colSpan:2,style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"PACKAGING"}),e.jsx(t,{colSpan:3,style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:parseInt(o)-1}),e.jsx(t,{colSpan:2,style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:o}),e.jsx(t,{rowSpan:2,style:{backgroundColor:"#3b82f6 !important",color:"white !important",verticalAlign:"middle",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"QTY/ PKG"}),e.jsx(t,{colSpan:3,style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"LT"}),e.jsx(t,{colSpan:4,style:{backgroundColor:"#2563eb !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"TOTAL KEBUTUHAN"}),e.jsx(t,{rowSpan:2,style:{backgroundColor:"#3b82f6 !important",color:"white !important",verticalAlign:"middle",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"ACTUAL"}),e.jsx(t,{rowSpan:2,style:{backgroundColor:"#3b82f6 !important",color:"white !important",verticalAlign:"middle",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"STATUS"}),e.jsx(t,{rowSpan:2,style:{backgroundColor:"#3b82f6 !important",color:"white !important",verticalAlign:"middle",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"GAP"})]}),e.jsxs(c,{children:[e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"JENIS"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"QTY"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"OCT"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"NOV"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"DEC"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"JAN"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"FEB"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"PRD"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"ST"}),e.jsx(t,{style:{backgroundColor:"#3b82f6 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"CUS"}),e.jsx(t,{style:{backgroundColor:"#1d4ed8 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"PRD"}),e.jsx(t,{style:{backgroundColor:"#1d4ed8 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"ST"}),e.jsx(t,{style:{backgroundColor:"#1d4ed8 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"CUS"}),e.jsx(t,{style:{backgroundColor:"#1d4ed8 !important",color:"white !important",textAlign:"center",border:"1px solid rgba(255,255,255,0.3) !important"},children:"TOTAL"})]})]}),e.jsx(T,{children:i.map((r,a)=>{const s=r.status==="Pass"?"#22c55e":r.status==="Kurang"?"#ef4444":"#f59e0b";return e.jsxs(c,{style:{backgroundColor:a%2===0?"#fff":"#f8fafc"},children:[e.jsx(n,{style:{textAlign:"center",fontWeight:"600"},children:r.part_number}),e.jsx(n,{style:{textAlign:"center"},children:r.packaging}),e.jsx(n,{style:{textAlign:"center",fontWeight:"700"},children:r.qty_packaging}),e.jsx(n,{style:{textAlign:"center"},children:Math.round((r.forecasts[`Oktober_${parseInt(o)-1}`]||0)/r.hari_kerja)}),e.jsx(n,{style:{textAlign:"center"},children:Math.round((r.forecasts[`November_${parseInt(o)-1}`]||0)/r.hari_kerja)}),e.jsx(n,{style:{textAlign:"center"},children:Math.round((r.forecasts[`Desember_${parseInt(o)-1}`]||0)/r.hari_kerja)}),e.jsx(n,{style:{textAlign:"center"},children:Math.round((r.forecasts[`Januari_${o}`]||0)/r.hari_kerja)}),e.jsx(n,{style:{textAlign:"center"},children:Math.round((r.forecasts[`Februari_${o}`]||0)/r.hari_kerja)}),e.jsx(n,{style:{textAlign:"center",color:"#64748b"},children:r.qty_packaging}),e.jsx(n,{style:{textAlign:"center"},children:r.lt_production}),e.jsx(n,{style:{textAlign:"center"},children:r.lt_store}),e.jsx(n,{style:{textAlign:"center"},children:r.lt_customer}),e.jsx(n,{style:{textAlign:"center",fontWeight:"bold",color:"#1d4ed8"},children:r.need_prod||0}),e.jsx(n,{style:{textAlign:"center",fontWeight:"bold",color:"#1d4ed8"},children:r.need_store||0}),e.jsx(n,{style:{textAlign:"center",fontWeight:"bold",color:"#1d4ed8"},children:r.need_cust||0}),e.jsx(n,{style:{textAlign:"center",fontWeight:"800",backgroundColor:"#eff6ff",color:"#1e3a8a"},children:r.total_need}),e.jsx(n,{style:{textAlign:"center",fontWeight:"800",color:"#1e293b"},children:r.actual}),e.jsx(n,{style:{textAlign:"center"},children:e.jsx("span",{style:{padding:"4px 10px",borderRadius:"20px",fontSize:"0.75rem",fontWeight:"700",backgroundColor:`${s}15`,color:s,border:`1px solid ${s}30`},children:r.status})}),e.jsx(n,{style:{textAlign:"center",fontWeight:"700",color:r.gap<0?"#ef4444":"#22c55e"},children:r.gap>0?`+${r.gap}`:r.gap})]},a)})})]})]})})]}),e.jsx(S,{md:3,children:e.jsx(j,{style:{borderRadius:"12px",border:"none",boxShadow:"0 4px 15px rgba(0,0,0,0.05)"},children:e.jsxs(C,{style:{padding:"20px"},children:[e.jsx("h5",{style:{fontWeight:"700",marginBottom:"20px",color:"#1e293b",fontSize:"1rem"},children:"Judgment"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[e.jsx(A,{label:"Kurang",count:f.Kurang,color:"#ef4444"}),e.jsx(A,{label:"Lebih",count:f.Lebih,color:"#f59e0b"}),e.jsx(A,{label:"Pass",count:f.Pass,color:"#22c55e"})]})]})})})]})]})},A=({label:g,count:h,color:x})=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 15px",borderRadius:"10px",backgroundColor:"#f8fafc"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"12px",height:"12px",backgroundColor:x,borderRadius:"50%"}}),e.jsx("span",{style:{fontSize:"0.9rem",fontWeight:"600",color:"#475569"},children:g})]}),e.jsx("span",{style:{fontWeight:"800",color:x,fontSize:"1.1rem"},children:h})]});export{Y as default};
